import{c as D,g as ge,r as _,j as e,M as be}from"./app-BXah4JEC.js";import{M as je}from"./MainLayout-BCyjf06V.js";import{d as X}from"./index-DTvp0qfx.js";import{S as E}from"./sweetalert2.esm.all-BkU8I-GU.js";var B,Z;function me(){if(Z)return B;Z=1;function r(t){var o=typeof t;return t!=null&&(o=="object"||o=="function")}return B=r,B}var $,Q;function he(){if(Q)return $;Q=1;var r=typeof D=="object"&&D&&D.Object===Object&&D;return $=r,$}var M,V;function de(){if(V)return M;V=1;var r=he(),t=typeof self=="object"&&self&&self.Object===Object&&self,o=r||t||Function("return this")();return M=o,M}var A,ee;function ve(){if(ee)return A;ee=1;var r=de(),t=function(){return r.Date.now()};return A=t,A}var P,te;function pe(){if(te)return P;te=1;var r=/\s/;function t(o){for(var l=o.length;l--&&r.test(o.charAt(l)););return l}return P=t,P}var L,ae;function we(){if(ae)return L;ae=1;var r=pe(),t=/^\s+/;function o(l){return l&&l.slice(0,r(l)+1).replace(t,"")}return L=o,L}var G,re;function fe(){if(re)return G;re=1;var r=de(),t=r.Symbol;return G=t,G}var W,ne;function ye(){if(ne)return W;ne=1;var r=fe(),t=Object.prototype,o=t.hasOwnProperty,l=t.toString,u=r?r.toStringTag:void 0;function j(i){var m=o.call(i,u),d=i[u];try{i[u]=void 0;var s=!0}catch{}var x=l.call(i);return s&&(m?i[u]=d:delete i[u]),x}return W=j,W}var F,se;function Ne(){if(se)return F;se=1;var r=Object.prototype,t=r.toString;function o(l){return t.call(l)}return F=o,F}var K,oe;function ke(){if(oe)return K;oe=1;var r=fe(),t=ye(),o=Ne(),l="[object Null]",u="[object Undefined]",j=r?r.toStringTag:void 0;function i(m){return m==null?m===void 0?u:l:j&&j in Object(m)?t(m):o(m)}return K=i,K}var H,le;function _e(){if(le)return H;le=1;function r(t){return t!=null&&typeof t=="object"}return H=r,H}var z,ie;function Se(){if(ie)return z;ie=1;var r=ke(),t=_e(),o="[object Symbol]";function l(u){return typeof u=="symbol"||t(u)&&r(u)==o}return z=l,z}var J,ce;function Te(){if(ce)return J;ce=1;var r=we(),t=me(),o=Se(),l=NaN,u=/^[-+]0x[0-9a-f]+$/i,j=/^0b[01]+$/i,i=/^0o[0-7]+$/i,m=parseInt;function d(s){if(typeof s=="number")return s;if(o(s))return l;if(t(s)){var x=typeof s.valueOf=="function"?s.valueOf():s;s=t(x)?x+"":x}if(typeof s!="string")return s===0?s:+s;s=r(s);var b=j.test(s);return b||i.test(s)?m(s.slice(2),b?2:8):u.test(s)?l:+s}return J=d,J}var U,ue;function Ie(){if(ue)return U;ue=1;var r=me(),t=ve(),o=Te(),l="Expected a function",u=Math.max,j=Math.min;function i(m,d,s){var x,b,S,h,g,v,w=0,T=!1,N=!1,I=!0;if(typeof m!="function")throw new TypeError(l);d=o(d)||0,r(s)&&(T=!!s.leading,N="maxWait"in s,S=N?u(o(s.maxWait)||0,d):S,I="trailing"in s?!!s.trailing:I);function C(c){var y=x,O=b;return x=b=void 0,w=c,h=m.apply(O,y),h}function q(c){return w=c,g=setTimeout(f,d),T?C(c):h}function a(c){var y=c-v,O=c-w,Y=d-y;return N?j(Y,S-O):Y}function n(c){var y=c-v,O=c-w;return v===void 0||y>=d||y<0||N&&O>=S}function f(){var c=t();if(n(c))return p(c);g=setTimeout(f,a(c))}function p(c){return g=void 0,I&&x?C(c):(x=b=void 0,h)}function k(){g!==void 0&&clearTimeout(g),w=0,x=v=b=g=void 0}function xe(){return g===void 0?h:p(t())}function R(){var c=t(),y=n(c);if(x=arguments,b=this,v=c,y){if(g===void 0)return q(v);if(N)return clearTimeout(g),g=setTimeout(f,d),C(v)}return g===void 0&&(g=setTimeout(f,d)),h}return R.cancel=k,R.flush=xe,R}return U=i,U}var Ce=Ie();const Oe=ge(Ce);function Be({rekapizin:r,presensihariini:t,historibulanini:o,namabulan:l,bulanini:u,rekapPresensi:j,user:i,shift:m,shiftKerjaTerisi:d,shiftKerja:s}){const x=()=>{const a=new Date,n=new Date(a.getFullYear(),a.getMonth(),1),f=a.getDate(),p=n.getDay();return`Minggu ke-${Math.ceil((f+p)/7)}`},[b,S]=_.useState(x());_.useEffect(()=>{S(x())},[]);const[h,g]=_.useState("bulanIni"),v=[{key:"bulanIni",label:"Bulan Ini"},{key:"shiftKerja",label:"Shift Kerja"}],[w,T]=_.useState({senin:"",selasa:"",rabu:"",kamis:"",jumat:"",sabtu:"",minggu:""});_.useEffect(()=>{if(d){const a={};d.forEach(n=>{a[n.hari.toLowerCase()]=n.kode_jamkerja}),T(a)}},[d]);const N=Oe(a=>{X.Inertia.post(route("dashboard.setShiftKerja"),{id:i.id,nama:i.nama_lengkap,shift:a},{preserveScroll:!0,onSuccess:()=>{toast.success("Shift berhasil disimpan!",{duration:3e3})},onError:n=>{console.error("Gagal menyimpan shift:",n),toast.error("Terjadi kesalahan saat menyimpan shift kerja. Silakan coba lagi.",{duration:5e3})}})},300),I=(a,n)=>{const f={...w,[a]:n};T(f),E.fire({title:"Shift Diperbarui",text:`Shift untuk hari ${a.charAt(0).toUpperCase()+a.slice(1)} telah diubah.`,icon:"success",timer:2e3,timerProgressBar:!0,showConfirmButton:!1,customClass:{popup:"custom-swal-popup",title:"custom-swal-title",content:"custom-swal-content"}}).then(()=>{N(f)})},C=[{type:"Hadir",iconName:"checkmark-done-outline",iconColor:"text-blue-500",count:j.hadir||0},{type:"Izin",iconName:"document-outline",iconColor:"text-green-500",count:r.jmlizin||0},{type:"Sakit",iconName:"medkit-outline",iconColor:"text-yellow-500",count:r.jmlsakit||0}];function q(){const[a,n]=_.useState(new Date);_.useEffect(()=>{const k=setInterval(()=>{n(new Date)},1e3);return()=>clearInterval(k)},[]);const f=new Intl.DateTimeFormat("id-ID",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1,timeZone:"Asia/Jakarta"}).format(a),p=new Intl.DateTimeFormat("id-ID",{weekday:"long",day:"numeric",month:"long",year:"numeric"}).format(a);return e.jsxs("div",{className:"text-white text-center mb-6",children:[e.jsx("div",{className:"text-4xl font-extrabold",children:f}),e.jsx("div",{className:"text-lg mt-1",children:p})]})}return e.jsxs(je,{children:[e.jsx(be,{title:"Dasbor | E-Presensi SMS"}),e.jsxs("div",{className:"bg-gray-100 min-h-screen overflow-y-auto pb-24",children:[e.jsxs("div",{className:"bg-blue-950 shadow-md rounded-b-sm p-4 flex items-center justify-between overflow-hidden",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"rounded-full overflow-hidden w-16 h-16 border-4 border-blue-500",children:e.jsx("img",{src:i.foto?`/storage/${i.foto}`:"/assets/img/sample/avatar/avatar1.jpg",alt:"avatar",className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h3",{className:"text-lg text-white font-semibold",children:i.nama_lengkap}),e.jsxs("p",{className:"text-white text-sm mt-1",children:[i.posisi==="operator"?"Operator":i.posisi==="staff"?"Staff":i.posisi==="security"?"Security":i.posisi==="cleaning service"?"Cleaning Service":"Jabatan Tidak Diketahui"," ","-"," ",e.jsx("span",{className:"font-medium text-blue-300",children:"44.595.18"})]})]})]}),e.jsx("a",{href:"#",className:"flex items-center justify-center bg-red-500 text-white rounded-full p-2 shadow-lg hover:bg-red-600 active:bg-red-700 transition duration-300 w-12 h-12",onClick:a=>{a.preventDefault(),E.fire({title:"Konfirmasi Logout",text:"Apakah Anda yakin ingin logout?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Ya, Logout",cancelButtonText:"Batal",customClass:{popup:"custom-swal-popup",title:"custom-swal-title",content:"custom-swal-content",confirmButton:"custom-swal-confirm",cancelButton:"custom-swal-cancel"}}).then(n=>{n.isConfirmed&&X.Inertia.post(route("logout"))})},children:e.jsx("ion-icon",{name:"exit",className:"text-xl"})})]}),e.jsxs("div",{className:"relative w-full overflow-hidden pb-8",children:[e.jsx("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:"url('/assets/img/operator.jpeg')",backgroundSize:"cover",backgroundPosition:"center 70%",width:"100%",height:"100%"}}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-35"}),e.jsxs("div",{className:"relative z-10 px-6 py-10 max-w-xl mx-auto",children:[e.jsx(q,{}),e.jsx("h3",{className:"text-lg font-semibold mb-4 text-white",children:"Presensi Hari Ini"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("div",{className:`rounded-lg shadow-lg p-4 flex items-center justify-between transition duration-300 ${t!=null&&t.jam_in?"bg-gray-300 text-gray-600 cursor-not-allowed":"bg-gradient-to-r from-green-400 to-green-500 text-white"}`,onClick:()=>{t!=null&&t.jam_in||(window.location.href="/presensi/create")},children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:t!=null&&t.foto_in?e.jsx("img",{src:`/storage/uploads/absensi/${t.foto_in}`,alt:"Absen Masuk",className:"w-12 h-12 rounded-full border-2 border-white"}):e.jsx("ion-icon",{name:"camera-outline",className:"text-4xl text-white"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h4",{className:"text-sm font-bold",children:"Masuk"}),e.jsx("span",{className:"text-xs",children:(t==null?void 0:t.jam_in)||"Klik untuk Absen"})]})]})}),e.jsx("div",{className:`rounded-lg shadow-lg p-4 flex items-center justify-between transition duration-300 ${t!=null&&t.jam_out?"bg-gray-300 text-gray-600 cursor-not-allowed":"bg-gradient-to-r from-red-400 to-red-500 text-white"}`,onClick:()=>{t!=null&&t.jam_in?window.location.href="/presensi/create":E.fire({title:"Oops!",text:"Belum melakukan absen masuk",icon:"warning",timer:3e3,timerProgressBar:!0,showConfirmButton:!1,customClass:{popup:"custom-swal-popup",title:"custom-swal-title",content:"custom-swal-content"}})},children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:t!=null&&t.foto_out?e.jsx("img",{src:`/storage/uploads/absensi/${t.foto_out}`,alt:"Absen Pulang",className:"w-12 h-12 rounded-full border-2 border-white"}):e.jsx("ion-icon",{name:"camera-outline",className:"text-4xl text-white"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h4",{className:"text-sm font-bold",children:"Pulang"}),e.jsx("span",{className:"text-xs",children:(t==null?void 0:t.jam_out)||"Klik untuk Absen"})]})]})})]})]})]}),e.jsx("div",{className:"flex justify-between border-b bg-white",children:v.map(a=>e.jsx("button",{className:`flex-1 px-4 py-2 text-center font-semibold ${h===a.key?"text-blue-500 border-b-2 border-blue-500":"text-gray-500"}`,onClick:()=>g(a.key),children:a.label},a.key))}),h==="bulanIni"&&e.jsxs("div",{children:[e.jsx("div",{children:e.jsxs("div",{className:"p-4",id:"rekappresensi",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 text-center",children:["Rekap Presensi Bulan ",l[u]]}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:C.map((a,n)=>e.jsxs("div",{className:"relative bg-white shadow rounded-lg p-3 flex flex-col items-center justify-center",children:[a.count>0&&e.jsx("span",{className:"absolute top-1 right-1 bg-red-500 text-white rounded-full text-xs font-bold px-2 py-0.5 shadow-lg",children:a.count}),e.jsx("ion-icon",{name:a.iconName,className:`${a.iconColor} text-4xl mb-2`}),e.jsx("span",{className:"text-sm font-medium text-gray-700 mt-2",children:a.type})]},n))})]})}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Histori Bulan Ini"}),o.length>0?o.sort((a,n)=>new Date(a.tanggal_presensi)-new Date(n.tanggal_presensi)).map((a,n)=>{const f=(()=>{if(!a.jam_in||!m||!m.jam_masuk)return null;const p=new Date(`1970-01-01T${a.jam_in}`),k=new Date(`1970-01-01T${m.jam_masuk}`);return isNaN(p.getTime())||isNaN(k.getTime())?null:p>k})();return e.jsxs("div",{className:`p-3 rounded-lg shadow-md mb-3 flex items-start gap-3 border-l-8 transition duration-300 hover:shadow-lg ${a.status==="h"?"border-green-500 bg-green-50":a.status==="i"?"border-yellow-500 bg-yellow-50":"border-red-500 bg-red-50"}`,children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:`w-9 h-9 flex items-center justify-center rounded-full text-md font-semibold ${a.status==="h"?"bg-green-500 text-white":a.status==="i"?"bg-yellow-500 text-white":"bg-red-500 text-white"}`,children:a.status.toUpperCase()})}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("h5",{className:"text-sm font-semibold text-gray-800",children:new Date(a.tanggal_presensi).toLocaleDateString("id-ID",{weekday:"long",day:"2-digit",month:"long",year:"numeric"})}),e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:a.keterangan||"Hadir"}),e.jsxs("div",{className:"text-xs flex items-center",children:[e.jsx("span",{className:"text-green-700 font-semibold mr-1",children:"Jam Masuk:"}),e.jsx("span",{className:`text-gray-700 ${f?"text-red-500 font-semibold":""}`,children:a.jam_in||e.jsx("span",{className:"italic text-gray-500",children:"Belum Absen"})}),f&&e.jsx("span",{className:"ml-1 text-[9px] font-semibold bg-red-500 text-white px-1 rounded",children:"Terlambat"})]}),e.jsxs("p",{className:"text-xs flex items-center mt-1",children:[e.jsx("strong",{className:"text-red-700 mr-1",children:"Jam Pulang:"})," ",e.jsx("span",{className:"text-gray-700",children:a.jam_out||e.jsx("span",{className:"italic text-gray-500",children:"Belum Absen"})})]})]})]},n)}):e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{className:"text-gray-500 text-sm",children:"Belum ada data absensi bulan ini."})})]})]}),h==="shiftKerja"&&e.jsxs("div",{className:"p-4",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 text-center text-gray-800",children:["Shift Kerja ",b]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:["senin","selasa","rabu","kamis","jumat","sabtu","minggu"].map(a=>e.jsxs("div",{className:"bg-white shadow-md rounded-lg p-4 border border-gray-200 active:shadow-sm active:scale-95 transition",children:[e.jsx("h4",{className:"text-gray-700 font-semibold capitalize mb-2",children:a}),e.jsxs("select",{name:a,value:w[a]||"",onChange:n=>I(a,n.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg text-sm focus:ring focus:ring-blue-400 focus:border-blue-500 transition",children:[e.jsx("option",{value:"",children:"Pilih Shift Kerja"}),s.sort((n,f)=>n.nama_jamkerja.localeCompare(f.nama_jamkerja)).map(n=>e.jsx("option",{value:n.kode_jamkerja,children:`${n.nama_jamkerja} (${n.awal_jam_masuk} - ${n.jam_pulang})`},n.kode_jamkerja))]})]},a))})]})]})]})}export{Be as default};
