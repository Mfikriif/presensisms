import{c as q,g as be,r as y,j as e,M as ge}from"./app-rUq2sItI.js";import{M as he}from"./MainLayout-D6W3HJZZ.js";import{d as Z}from"./index-CRZVc7ho.js";import{S as B}from"./sweetalert2.esm.all-BkU8I-GU.js";var M,Q;function me(){if(Q)return M;Q=1;function a(r){var o=typeof r;return r!=null&&(o=="object"||o=="function")}return M=a,M}var $,V;function je(){if(V)return $;V=1;var a=typeof q=="object"&&q&&q.Object===Object&&q;return $=a,$}var L,ee;function fe(){if(ee)return L;ee=1;var a=je(),r=typeof self=="object"&&self&&self.Object===Object&&self,o=a||r||Function("return this")();return L=o,L}var A,te;function ve(){if(te)return A;te=1;var a=fe(),r=function(){return a.Date.now()};return A=r,A}var P,re;function pe(){if(re)return P;re=1;var a=/\s/;function r(o){for(var i=o.length;i--&&a.test(o.charAt(i)););return i}return P=r,P}var G,ae;function we(){if(ae)return G;ae=1;var a=pe(),r=/^\s+/;function o(i){return i&&i.slice(0,a(i)+1).replace(r,"")}return G=o,G}var F,ne;function xe(){if(ne)return F;ne=1;var a=fe(),r=a.Symbol;return F=r,F}var W,se;function ye(){if(se)return W;se=1;var a=xe(),r=Object.prototype,o=r.hasOwnProperty,i=r.toString,d=a?a.toStringTag:void 0;function g(l){var x=o.call(l,d),m=l[d];try{l[d]=void 0;var n=!0}catch{}var u=i.call(l);return n&&(x?l[d]=m:delete l[d]),u}return W=g,W}var K,oe;function Ne(){if(oe)return K;oe=1;var a=Object.prototype,r=a.toString;function o(i){return r.call(i)}return K=o,K}var z,ie;function ke(){if(ie)return z;ie=1;var a=xe(),r=ye(),o=Ne(),i="[object Null]",d="[object Undefined]",g=a?a.toStringTag:void 0;function l(x){return x==null?x===void 0?d:i:g&&g in Object(x)?r(x):o(x)}return z=l,z}var H,le;function Se(){if(le)return H;le=1;function a(r){return r!=null&&typeof r=="object"}return H=a,H}var J,ce;function _e(){if(ce)return J;ce=1;var a=ke(),r=Se(),o="[object Symbol]";function i(d){return typeof d=="symbol"||r(d)&&a(d)==o}return J=i,J}var U,ue;function Te(){if(ue)return U;ue=1;var a=we(),r=me(),o=_e(),i=NaN,d=/^[-+]0x[0-9a-f]+$/i,g=/^0b[01]+$/i,l=/^0o[0-7]+$/i,x=parseInt;function m(n){if(typeof n=="number")return n;if(o(n))return i;if(r(n)){var u=typeof n.valueOf=="function"?n.valueOf():n;n=r(u)?u+"":u}if(typeof n!="string")return n===0?n:+n;n=a(n);var b=g.test(n);return b||l.test(n)?x(n.slice(2),b?2:8):d.test(n)?i:+n}return U=m,U}var Y,de;function Ie(){if(de)return Y;de=1;var a=me(),r=ve(),o=Te(),i="Expected a function",d=Math.max,g=Math.min;function l(x,m,n){var u,b,N,j,f,v,p=0,O=!1,k=!1,_=!0;if(typeof x!="function")throw new TypeError(i);m=o(m)||0,a(n)&&(O=!!n.leading,k="maxWait"in n,N=k?d(o(n.maxWait)||0,m):N,_="trailing"in n?!!n.trailing:_);function T(c){var w=u,C=b;return u=b=void 0,p=c,j=x.apply(C,w),j}function R(c){return p=c,f=setTimeout(I,m),O?T(c):j}function E(c){var w=c-v,C=c-p,X=m-w;return k?g(X,N-C):X}function D(c){var w=c-v,C=c-p;return v===void 0||w>=m||w<0||k&&C>=N}function I(){var c=r();if(D(c))return t(c);f=setTimeout(I,E(c))}function t(c){return f=void 0,_&&u?T(c):(u=b=void 0,j)}function s(){f!==void 0&&clearTimeout(f),p=0,u=v=b=f=void 0}function h(){return f===void 0?j:t(r())}function S(){var c=r(),w=D(c);if(u=arguments,b=this,v=c,w){if(f===void 0)return R(v);if(k)return clearTimeout(f),f=setTimeout(I,m),T(v)}return f===void 0&&(f=setTimeout(I,m)),j}return S.cancel=s,S.flush=h,S}return Y=l,Y}var Ce=Ie();const Oe=be(Ce);function Be({rekapizin:a,presensihariini:r,historibulanini:o,namabulan:i,bulanini:d,rekapPresensi:g,user:l,shift:x,shiftKerjaTerisi:m,shiftKerja:n}){const[u,b]=y.useState("semua"),N=o.filter(t=>{if(u==="semua")return!0;if(u==="hadir")return t.status==="h";if(u==="izin")return t.status==="i";if(u==="sakit")return t.status==="s"}),j=()=>{const t=new Date,s=new Date(t.getFullYear(),t.getMonth(),1),h=t.getDate(),S=s.getDay();return`Minggu ke-${Math.ceil((h+S)/7)}`},[f,v]=y.useState(j());y.useEffect(()=>{v(j())},[]);const[p,O]=y.useState("bulanIni"),k=[{key:"bulanIni",label:"Bulan Ini"},{key:"shiftKerja",label:"Shift Kerja"}],[_,T]=y.useState({senin:"",selasa:"",rabu:"",kamis:"",jumat:"",sabtu:"",minggu:""});y.useEffect(()=>{if(m){const t={};m.forEach(s=>{t[s.hari.toLowerCase()]=s.kode_jamkerja}),T(t)}},[m]);const R=Oe(t=>{Z.Inertia.post(route("dashboard.setShiftKerja"),{id:l.id,nama:l.nama_lengkap,shift:t},{preserveScroll:!0,onSuccess:()=>{toast.success("Shift berhasil disimpan!",{duration:3e3})},onError:s=>{console.error("Gagal menyimpan shift:",s),toast.error("Terjadi kesalahan saat menyimpan shift kerja. Silakan coba lagi.",{duration:5e3})}})},300),E=(t,s)=>{const h={..._,[t]:s};T(h),B.fire({title:"Shift Diperbarui",text:`Shift untuk hari ${t.charAt(0).toUpperCase()+t.slice(1)} telah diubah.`,icon:"success",timer:2e3,timerProgressBar:!0,showConfirmButton:!1,customClass:{popup:"custom-swal-popup",title:"custom-swal-title",content:"custom-swal-content"}}).then(()=>{R(h)})},D=[{type:"Hadir",iconName:"checkmark-done-outline",iconColor:"text-blue-500",count:g.hadir||0},{type:"Izin",iconName:"document-outline",iconColor:"text-green-500",count:a.jmlizin||0},{type:"Sakit",iconName:"medkit-outline",iconColor:"text-yellow-500",count:a.jmlsakit||0}];function I(){const[t,s]=y.useState(new Date);y.useEffect(()=>{const c=setInterval(()=>{s(new Date)},1e3);return()=>clearInterval(c)},[]);const h=new Intl.DateTimeFormat("id-ID",{hour:"2-digit",minute:"2-digit",second:"2-digit",hour12:!1,timeZone:"Asia/Jakarta"}).format(t),S=new Intl.DateTimeFormat("id-ID",{weekday:"long",day:"numeric",month:"long",year:"numeric"}).format(t);return e.jsxs("div",{className:"text-white text-center mb-6",children:[e.jsx("div",{className:"text-4xl font-extrabold",children:h}),e.jsx("div",{className:"text-lg mt-1",children:S})]})}return e.jsxs(he,{children:[e.jsx(ge,{title:"Dasbor | E-Presensi SMS"}),e.jsxs("div",{className:"bg-gray-100 min-h-screen overflow-y-auto pb-24 pt-20",children:[e.jsxs("div",{className:"fixed top-0 left-0 right-0 z-50 bg-blue-950 shadow-md rounded-b-sm p-4 flex items-center justify-between overflow-hidden",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"rounded-full overflow-hidden w-16 h-16 border-4 border-red-500",children:e.jsx("img",{src:l.foto?`/storage/${l.foto}`:"/assets/img/sample/avatar/avatar1.jpg",alt:"avatar",className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h3",{className:"text-lg text-white font-semibold",children:l.nama_lengkap}),e.jsxs("p",{className:"text-white text-sm mt-1",children:[l.posisi==="operator"?"Operator":l.posisi==="staff"?"Staff":l.posisi==="security"?"Security":l.posisi==="cleaning service"?"Cleaning Service":"Jabatan Tidak Diketahui"," ","-"," ",e.jsx("span",{className:"font-medium text-blue-300",children:"44.595.18"})]})]})]}),e.jsx("a",{href:"#",className:"flex items-center justify-center bg-red-500 text-white rounded-full p-2 shadow-lg hover:bg-red-600 active:bg-red-700 transition duration-300 w-12 h-12",onClick:t=>{t.preventDefault(),B.fire({title:"Konfirmasi Logout",text:"Apakah Anda yakin ingin logout?",icon:"warning",showCancelButton:!0,confirmButtonColor:"#d33",cancelButtonColor:"#3085d6",confirmButtonText:"Ya, Logout",cancelButtonText:"Batal",customClass:{popup:"custom-swal-popup",title:"custom-swal-title",content:"custom-swal-content",confirmButton:"custom-swal-confirm",cancelButton:"custom-swal-cancel"}}).then(s=>{s.isConfirmed&&Z.Inertia.post(route("logout"))})},children:e.jsx("ion-icon",{name:"exit",className:"text-xl"})})]}),e.jsxs("div",{className:"relative w-full overflow-hidden pb-8",children:[e.jsx("div",{className:"absolute inset-0 bg-cover bg-center",style:{backgroundImage:"url('/assets/img/operator.jpeg')",backgroundSize:"cover",backgroundPosition:"center 70%",width:"100%",height:"100%"}}),e.jsx("div",{className:"absolute inset-0 bg-black bg-opacity-35"}),e.jsxs("div",{className:"relative z-10 px-6 py-10 max-w-xl mx-auto",children:[e.jsx(I,{}),e.jsx("h3",{className:"text-lg font-semibold mb-4 text-white",children:"Presensi Hari Ini"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx("div",{className:`rounded-lg shadow-lg p-4 flex items-center justify-between transition duration-300 ${r!=null&&r.jam_in?"bg-gray-300 text-gray-600 cursor-not-allowed":"bg-gradient-to-r from-green-400 to-green-500 text-white"}`,onClick:()=>{r!=null&&r.jam_in||(window.location.href="/presensi/create")},children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:r!=null&&r.foto_in?e.jsx("img",{src:`/storage/uploads/absensi/${r.foto_in}`,alt:"Absen Masuk",className:"w-12 h-12 rounded-full border-2 border-white"}):e.jsx("ion-icon",{name:"camera-outline",className:"text-4xl text-white"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h4",{className:"text-sm font-bold",children:"Masuk"}),e.jsx("span",{className:"text-xs",children:(r==null?void 0:r.jam_in)||"Klik untuk Absen"})]})]})}),e.jsx("div",{className:`rounded-lg shadow-lg p-4 flex items-center justify-between transition duration-300 ${r!=null&&r.jam_out?"bg-gray-300 text-gray-600 cursor-not-allowed":"bg-gradient-to-r from-red-400 to-red-500 text-white"}`,onClick:()=>{r!=null&&r.jam_in?window.location.href="/presensi/create":B.fire({title:"Oops!",text:"Belum melakukan absen masuk",icon:"warning",timer:3e3,timerProgressBar:!0,showConfirmButton:!1,customClass:{popup:"custom-swal-popup",title:"custom-swal-title",content:"custom-swal-content"}})},children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0",children:r!=null&&r.foto_out?e.jsx("img",{src:`/storage/uploads/absensi/${r.foto_out}`,alt:"Absen Pulang",className:"w-12 h-12 rounded-full border-2 border-white"}):e.jsx("ion-icon",{name:"camera-outline",className:"text-4xl text-white"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("h4",{className:"text-sm font-bold",children:"Pulang"}),e.jsx("span",{className:"text-xs",children:(r==null?void 0:r.jam_out)||"Klik untuk Absen"})]})]})})]})]})]}),e.jsx("div",{className:"flex justify-between border-b bg-white",children:k.map(t=>e.jsx("button",{className:`flex-1 px-4 py-2 text-center font-semibold ${p===t.key?"text-blue-500 border-b-2 border-blue-500":"text-gray-500"}`,onClick:()=>O(t.key),children:t.label},t.key))}),p==="bulanIni"&&e.jsxs("div",{children:[e.jsx("div",{children:e.jsxs("div",{className:"p-4",id:"rekappresensi",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 text-center",children:["Rekap Presensi Bulan ",i[d]]}),e.jsxs("div",{className:"grid grid-cols-2 sm:flex sm:flex-wrap justify-center gap-3",children:[e.jsx("button",{onClick:()=>b("semua"),className:`w-full sm:w-auto px-4 py-2 rounded-lg text-sm font-semibold border transition text-center
            ${u==="semua"?"bg-blue-950 text-white border-blue-950":"bg-white text-gray-700 border-gray-300 hover:bg-gray-50"}`,children:"Semua"}),D.map((t,s)=>e.jsxs("button",{onClick:()=>b(t.type.toLowerCase()),className:`relative w-full sm:w-auto rounded-lg px-4 py-2 text-sm font-semibold flex flex-col items-center justify-center shadow-md transition duration-200 border
                ${u===t.type.toLowerCase()?"border-blue-950 ring-2 ring-blue-200":"border-transparent bg-white hover:bg-gray-100"}`,children:[t.count>0&&e.jsx("span",{className:"absolute top-1 right-1 bg-red-500 text-white rounded-full text-xs font-bold px-2 py-0.5 shadow-lg",children:t.count}),e.jsx("ion-icon",{name:t.iconName,className:`${t.iconColor} text-3xl mb-1`}),e.jsx("span",{className:"text-xs",children:t.type})]},s))]})]})}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Histori Bulan Ini"}),N.length>0?N.sort((t,s)=>new Date(t.tanggal_presensi)-new Date(s.tanggal_presensi)).map((t,s)=>e.jsxs("div",{className:`p-3 rounded-lg shadow-md mb-3 flex items-start gap-3 border-l-8 transition duration-300 hover:shadow-lg ${t.status==="h"?"border-green-500 bg-green-50":t.status==="i"?"border-yellow-500 bg-yellow-50":"border-red-500 bg-red-50"}`,children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:`w-9 h-9 flex items-center justify-center rounded-full text-md font-semibold ${t.status==="h"?"bg-green-500 text-white":t.status==="i"?"bg-yellow-500 text-white":"bg-red-500 text-white"}`,children:t.status.toUpperCase()})}),e.jsxs("div",{className:"flex-grow",children:[e.jsx("h5",{className:"text-sm font-semibold text-gray-800",children:new Date(t.tanggal_presensi).toLocaleDateString("id-ID",{weekday:"long",day:"2-digit",month:"long",year:"numeric"})}),e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:t.keterangan||"Hadir"}),t.status==="h"&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"text-xs flex items-center",children:[e.jsx("span",{className:"text-green-700 font-semibold mr-1",children:"Jam Masuk:"}),e.jsx("span",{className:"text-gray-700",children:t.jam_in||e.jsx("span",{className:"italic text-gray-500",children:"Belum Absen"})}),t.terlambat&&e.jsxs("span",{className:"ml-1 text-[9px] font-semibold bg-red-500 text-white px-1 rounded",children:["Terlambat"," ",Math.floor(t.terlambat_menit/60)>0&&e.jsxs(e.Fragment,{children:[Math.floor(t.terlambat_menit/60)," ","jam"," "]}),t.terlambat_menit%60," ","menit"]}),!t.terlambat&&t.jam_in&&e.jsx("span",{className:"ml-1 text-[9px] font-semibold bg-green-500 text-white px-1 rounded",children:"Tepat Waktu"})]}),e.jsxs("p",{className:"text-xs flex items-center mt-1",children:[e.jsx("strong",{className:"text-red-700 mr-1",children:"Jam Pulang:"})," ",e.jsx("span",{className:"text-gray-700",children:t.jam_out||e.jsx("span",{className:"italic text-gray-500",children:"Belum Absen"})})]})]})]})]},s)):e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{className:"text-gray-500 text-sm",children:"Belum ada data absensi bulan ini."})})]})]}),p==="shiftKerja"&&e.jsxs("div",{className:"p-4 pb-16",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 text-center text-gray-800",children:["Shift Kerja ",f]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:["senin","selasa","rabu","kamis","jumat","sabtu","minggu"].map(t=>e.jsxs("div",{className:"bg-white shadow-sm rounded-xl p-4 border border-gray-200 hover:shadow-md transition duration-200",children:[e.jsx("h4",{className:"text-sm font-semibold capitalize text-gray-700 mb-2",children:t}),e.jsxs("select",{name:t,value:_[t]||"",onChange:s=>E(t,s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg text-sm bg-white focus:outline-none focus:ring-2 focus:ring-blue-400 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Pilih Shift Kerja"}),n.sort((s,h)=>s.nama_jamkerja.localeCompare(h.nama_jamkerja)).map(s=>e.jsx("option",{value:s.kode_jamkerja,children:`${s.nama_jamkerja} (${s.awal_jam_masuk} - ${s.jam_pulang})`},s.kode_jamkerja))]})]},t))})]})]})]})}export{Be as default};
